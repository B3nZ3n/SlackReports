# Rapport ZQSD004: pings

```{r ZQSD004, echo=FALSE}
#ne garder que les messages contenant un "@" vers un user
allMessages %>% filter(str_detect(text, "<@.*>")) -> pings

#extraire le ou les users pingés dans une nouvelle colonne
pings$pinged <- str_extract_all(pings$text, "(?<=<@).{9}")

#on expand la liste des users contenus dans pinged
pings <- tidyr::unnest(pings, cols = pinged)

pings <- pings[!pings$username == "NA",c("username","pinged")]

pings$pinged <- with(allUsers, name[match(pings$pinged, id)])

#on aggrège le nombre de ping par user
pings %>% group_by(username, pinged) %>%
  summarise(count_ping = n())  -> pings

pings <- pings[!pings$pinged == "NA",]

p <- ggplot(pings,
            aes(x =pinged ,
                y = username ,
                fill = count_ping)) +
  geom_tile()+
  ggtitle("todo")+
  theme(axis.text.x = element_text(angle = -90, hjust = 0))

ggplotly(p, 
         width = 800,
         height = 600)
```
